# Customer_Behavious_Analysis

# Customer Purchase Behavior Analysis using SQL

![](https://img.freepik.com/free-vector/data-analysis-concept-illustration_114360-8053.jpg)

## Overview
This project focuses on analyzing customer purchase behavior using SQL to uncover insights related to revenue, discounts, subscriptions, shipping preferences, product performance, and customer segmentation. The analysis answers key business questions that help understand customer spending patterns and improve decision-making for sales and marketing strategies.

## Objectives

- Analyze revenue contribution by gender and age group  
- Understand the impact of discounts and subscriptions on spending  
- Identify top-performing products and categories  
- Compare customer behavior across shipping types  
- Segment customers based on purchase history  
- Explore relationships between repeat purchases and subscriptions  

## Dataset

The dataset represents customer-level transactional data from an e-commerce platform.  
Each record corresponds to a customer purchase and includes demographic, transactional, and behavioral attributes.

**Key attributes include:**
- Customer demographics (gender, age group)
- Purchase amount and product details
- Discount and subscription information
- Shipping preferences
- Review ratings and purchase history

## Schema

```sql
CREATE TABLE customer (
    customer_id INT,
    gender VARCHAR(10),
    age_group VARCHAR(20),
    item_purchased VARCHAR(100),
    category VARCHAR(50),
    purchase_amount NUMERIC,
    discount_applied VARCHAR(5),
    shipping_type VARCHAR(20),
    subscription_status VARCHAR(20),
    previous_purchases INT,
    review_rating VARCHAR(10)
);
```

## Business Problems and Solutions
1. What is the total revenue generated by male vs. female customers?
SELECT gender, SUM(purchase_amount) AS revenue
FROM customer
GROUP BY gender;


## Objective: Compare total revenue contribution across genders.

2. Which customers used a discount but still spent more than the average purchase amount?
SELECT customer_id, purchase_amount 
FROM customer 
WHERE discount_applied = 'Yes'
  AND purchase_amount >= (SELECT AVG(purchase_amount) FROM customer);


## Objective: Identify high-value customers who remain strong spenders despite discounts.

3. Which are the top 5 products with the highest average review rating?
SELECT item_purchased,
       ROUND(AVG(review_rating::numeric), 2) AS average_product_rating
FROM customer
GROUP BY item_purchased
ORDER BY AVG(review_rating) DESC
LIMIT 5;


## Objective: Determine the best-rated products based on customer reviews.

4. Compare the average purchase amounts between Standard and Express shipping
SELECT shipping_type,
       ROUND(AVG(purchase_amount), 2) AS avg_purchase_amount
FROM customer
WHERE shipping_type IN ('Standard', 'Express')
GROUP BY shipping_type;


## Objective: Analyze whether faster shipping influences customer spending.

5. Do subscribed customers spend more?
SELECT subscription_status,
       COUNT(customer_id) AS total_customers,
       ROUND(AVG(purchase_amount), 2) AS avg_spend,
       ROUND(SUM(purchase_amount), 2) AS total_revenue
FROM customer
GROUP BY subscription_status
ORDER BY total_revenue, avg_spend DESC;


## Objective: Compare spending behavior and revenue between subscribers and non-subscribers.

6. Which 5 products have the highest percentage of discounted purchases?
SELECT item_purchased,
       ROUND(
           100.0 * SUM(CASE WHEN discount_applied = 'Yes' THEN 1 ELSE 0 END) / COUNT(*),
           2
       ) AS discount_rate
FROM customer
GROUP BY item_purchased
ORDER BY discount_rate DESC
LIMIT 5;


## Objective: Identify products most frequently sold with discounts.

7. Segment customers into New, Returning, and Loyal customers
WITH customer_type AS (
    SELECT customer_id,
           previous_purchases,
           CASE 
               WHEN previous_purchases = 1 THEN 'New'
               WHEN previous_purchases BETWEEN 2 AND 10 THEN 'Returning'
               ELSE 'Loyal'
           END AS customer_segment
    FROM customer
)
SELECT customer_segment,
       COUNT(*) AS number_of_customers
FROM customer_type
GROUP BY customer_segment;


## Objective: Understand customer distribution based on purchase history.

8. What are the top 3 most purchased products within each category?
WITH item_counts AS (
    SELECT category,
           item_purchased,
           COUNT(customer_id) AS total_orders,
           ROW_NUMBER() OVER (PARTITION BY category ORDER BY COUNT(customer_id) DESC) AS item_rank
    FROM customer
    GROUP BY category, item_purchased
)
SELECT item_rank, category, item_purchased, total_orders
FROM item_counts
WHERE item_rank <= 3;


## Objective: Identify best-selling products across categories.

9. Are repeat buyers also likely to subscribe?
SELECT subscription_status,
       COUNT(customer_id) AS repeat_buyers
FROM customer
WHERE previous_purchases > 5
GROUP BY subscription_status;


## Objective: Examine the relationship between repeat purchases and subscriptions.

10. What is the revenue contribution of each age group?
SELECT age_group,
       SUM(purchase_amount) AS total_revenue
FROM customer
GROUP BY age_group
ORDER BY total_revenue DESC;


## Objective: Analyze which age groups contribute the most revenue.

## Findings and Conclusion

Certain genders and age groups contribute significantly more to total revenue.

Discounts do not always reduce spending; some discounted purchases exceed average order values.

Subscribed customers generally generate higher average spend and total revenue.

Loyal and returning customers form a strong base for long-term growth.

Product-level insights help identify high-performing items and categories.

This analysis supports data-driven decisions for pricing, marketing, customer retention, and subscription strategies.




